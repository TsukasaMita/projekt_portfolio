const questions = [
  {
    "question": "Which of the following are topics for the Developers to discuss at the Daily Scrum as they inspect their progress toward the Sprint Goal?",
    "answer": [
      {
        "text": "What have we learned since yesterday, and how should we modify our plan to increase our ability to meet the Sprint Goal?",
        "correct": true
      },
      {
        "text": "What will I be working on tomorrow?",
        "correct": false
      },
      {
        "text": "How many hours did I spend on the project yesterday?",
        "correct": false
      },
      {
        "text": "Will today's work negatively impact our ability to meet the Sprint Goal for the Sprint following this one?",
        "correct": false
      },
      {
        "text": "Why were you late?",
        "correct": false
      },
      {
        "text": "Are there any impediments blocking progress toward the Sprint Goal?",
        "correct": true
      },
      {
        "text": "Are there any decisions that need to be made to maintain progress toward the Sprint Goal?",
        "correct": true
      }
    ]
  },
  {
    "question": "A Scrum Team is a cohesive unit of professionals that consists of which of the following?",
    "answer": [
      {
        "text": "Users.",
        "correct": false
      },
      {
        "text": "One Product Owner.",
        "correct": true
      },
      {
        "text": "Customers.",
        "correct": false
      },
      {
        "text": "Developers.",
        "correct": true
      },
      {
        "text": "One Scrum Master.",
        "correct": true
      }
    ]
  },
  {
    "question": "Why is the Daily Scrum held at the same time and same place?",
    "answer": [
      {
        "text": "The Product Owner demands it.",
        "correct": false
      },
      {
        "text": "Rooms are hard to book and must be booked in advance.",
        "correct": false
      },
      {
        "text": "The place can be named.",
        "correct": false
      },
      {
        "text": "The consistency reduces complexity.",
        "correct": true
      }
    ]
  },
  {
    "question": "A Scrum Master is working with a Scrum Team that has Developers in different physical locations. The Developers meet in a variety of meeting rooms and have much to do logistically (for example: reserve meeting rooms and set up conference calls) before the Daily Scrum. What action should the Scrum Master take?",
    "answer": [
      {
        "text": "Allow the Developers to self-manage and determine for themselves what to do.",
        "correct": true
      },
      {
        "text": "Ask the Developers to alternate who is responsible for meeting setup.",
        "correct": false
      },
      {
        "text": "Set up the meeting and tell the Scrum Team that is how it will be done.",
        "correct": false
      },
      {
        "text": "Inform management and ask them to solve it.",
        "correct": false
      }
    ]
  },
  {
    "question": "Who creates the Definition of Done?",
    "answer": [
      {
        "text": "The Scrum Team",
        "correct": true
      },
      {
        "text": "The Developers",
        "correct": false
      },
      {
        "text": "The Product Owner",
        "correct": false
      },
      {
        "text": "The Scrum Master",
        "correct": false
      }
    ]
  },
  {
    "question": "Why does the Product Owner want the Developers to adhere to its Definition of Done?",
    "answer": [
      {
        "text": "To predict the team's productivity over time.",
        "correct": false
      },
      {
        "text": "To have complete transparency into what has been done at the end of each Sprint.",
        "correct": true
      },
      {
        "text": "To know what the team will deliver over the next three Sprints.",
        "correct": false
      },
      {
        "text": "To be able to reprimand the team when they do not meet their velocity goal for the Sprint.",
        "correct": false
      }
    ]
  },
  {
    "question": "How much time is required after a Sprint to prepare for the next Sprint?",
    "answer": [
      {
        "text": "The break between Sprints is timeboxed to one-week for a one-month Sprint, and usually less for shorter Sprints.",
        "correct": false
      },
      {
        "text": "Enough time for the requirements for the next Sprint to be determined and documented.",
        "correct": false
      },
      {
        "text": "Enough time for the Developers to finish the testing from the last Sprint.",
        "correct": false
      },
      {
        "text": "None. A new Sprint starts immediately following the end of the previous Sprint.",
        "correct": true
      },
      {
        "text": "All of the above are allowed depending on the situation.",
        "correct": false
      }
    ]
  },
  {
    "question": "Who determines how many Product Backlog items the Developers select for a Sprint?",
    "answer": [
      {
        "text": "The stakeholders attending Sprint Planning.",
        "correct": false
      },
      {
        "text": "The Scrum Team",
        "correct": false
      },
      {
        "text": "The Product Owner.",
        "correct": false
      },
      {
        "text": "The Developers.",
        "correct": true
      },
      {
        "text": "The Scrum Master.",
        "correct": false
      }
    ]
  },
  {
    "question": "What are two ways that regulatory compliance issues are dealt with in Scrum?",
    "answer": [
      {
        "text": "They are addressed along with functional development of the product.",
        "correct": true
      },
      {
        "text": "They are addressed by a separate team who is responsible for compliance issues.",
        "correct": false
      },
      {
        "text": "They are added to the Product Backlog and addressed in early Sprints, while always requiring at least some business functionality, no matter how small.",
        "correct": true
      },
      {
        "text": "They are discussed, determined, and documented before the actual feature development Sprints.",
        "correct": false
      }
    ]
  },
  {
    "question": "Which phrase best describes a Product Owner?",
    "answer": [
      {
        "text": "Team manager.",
        "correct": false
      },
      {
        "text": "Requirements engineer.",
        "correct": false
      },
      {
        "text": "Value optimizer.",
        "correct": true
      },
      {
        "text": "Go-between for the Developers and the customers.",
        "correct": false
      }
    ]
  },
  {
    "question": "During Sprint Planning the Product Owner and the Developers are unable to reach an understanding about the highest order Product Backlog items. Because of this, the Developers are unable to determine how many Product Backlog items they can forecast for the upcoming Sprint. However, the Product Owner and the Developers are able to agree on a Sprint Goal. Which of the following actions should the Scrum Master support?",
    "answer": [
      {
        "text": "Cancel the Sprint. Send the entire team to an advanced Scrum training and then start a new Sprint.",
        "correct": false
      },
      {
        "text": "Ask everyone to take as much time as needed to analyze the Product Backlog first, and then reconvene another Sprint Planning meeting.",
        "correct": false
      },
      {
        "text": "Continue the Sprint Planning event past its timebox until an adequate number of Product Backlog items are well enough understood for the Developers to make a complete forecast. Then start the Sprint.",
        "correct": false
      },
      {
        "text": "During the next Sprint Retrospective discuss why this happened and what changes will make it less likely to recur.",
        "correct": true
      },
      {
        "text": "Forecast the Product Backlog items that are most likely to meet the Sprint Goal and create the Sprint Backlog. Conclude Sprint Planning and start the development work. Continue to analyze, decompose, and create additional functionality during the Sprint.",
        "correct": true
      }
    ]
  },
  {
    "question": "Why do the Developers need a Sprint Goal?",
    "answer": [
      {
        "text": "A Sprint Goal only gives purpose to Sprint 0.",
        "correct": false
      },
      {
        "text": "Sprint Goals are not valuable. Everything is known from the Product Backlog.",
        "correct": false
      },
      {
        "text": "The Developers are more focused with a common yet specific goal.",
        "correct": true
      },
      {
        "text": "A Sprint Goal ensures that all of the Product Backlog items selected for the Sprint are implemented.",
        "correct": false
      }
    ]
  },
  {
    "question": "You are the Scrum Master of a new, to be developed Product. Development is going to require 45 people. What is a good first question for you to suggest the group thinks about when forming into teams?",
    "answer": [
      {
        "text": "Who are going to be the team leads?",
        "correct": false
      },
      {
        "text": "What is the right mixture of senior and junior people on each team?",
        "correct": false
      },
      {
        "text": "How will we make sure all teams have the right amount of expertise?",
        "correct": true
      },
      {
        "text": "Who are the subject matter experts on each team?",
        "correct": false
      }
    ]
  },
  {
    "question": "Which are characteristics of the Daily Scrum?",
    "answer": [
      {
        "text": "It is free form and designed to promote conversation.",
        "correct": false
      },
      {
        "text": "It is facilitated by the team lead.",
        "correct": false
      },
      {
        "text": "It is held first thing in the morning.",
        "correct": false
      },
      {
        "text": "It consists of the Scrum Master asking the team for status.",
        "correct": false
      },
      {
        "text": "Its location and time remain constant.",
        "correct": true
      },
      {
        "text": "Its purpose is to inspect progress toward the Sprint Goal and adapt the Sprint Backlog.",
        "correct": true
      }
    ]
  },
  {
    "question": "One of the Scrum events is the Daily Scrum. What are two intended outcomes of the Daily Scrum?",
    "answer": [
      {
        "text": "An updated Scrum board to make Sprint progress transparent for the stakeholders.",
        "correct": false
      },
      {
        "text": "Identification of impediments that may prevent the Developers from achieving the Sprint Goal.",
        "correct": true
      },
      {
        "text": "A status report for the upper management indicating what each individual has done, will be doing, and what is impeding him/her.",
        "correct": false
      },
      {
        "text": "A shared understanding of the most important work to be undertaken next to achieve the best possible progress toward the Sprint goal.",
        "correct": true
      },
      {
        "text": "An update of completed tasks and of the remaining work so the Scrum Master can plan the next day.",
        "correct": false
      }
    ]
  },
  {
    "question": "As the Sprint Planning progresses, the Developers realize that the workload may be greater than their capacity to complete the work. Which two are valid actions?",
    "answer": [
      {
        "text": "Cancel the Sprint.",
        "correct": false
      },
      {
        "text": "Remove or change selected Product Backlog items.",
        "correct": true
      },
      {
        "text": "The Developers work overtime during this Sprint.",
        "correct": false
      },
      {
        "text": "Recruit additional Developers before the work can begin.",
        "correct": false
      },
      {
        "text": "The Developers ensure that the Scrum Team is aware, start the Sprint, and monitor progress.",
        "correct": true
      }
    ]
  },
  {
    "question": "In accordance with Scrum theory, how should a group of 100 people be divided into multiple Scrum Teams?",
    "answer": [
      {
        "text": "Create a matrix of skills, seniority, and level of experience to assign people to teams.",
        "correct": false
      },
      {
        "text": "Check with the allocation department to see who has worked together before and make these the first teams.",
        "correct": false
      },
      {
        "text": "Understanding the product, the product vision and the rules of the Scrum framework, the people divide themselves into teams.",
        "correct": true
      },
      {
        "text": "It does not really matter since you can rotate the teams every Sprint to spread knowledge.",
        "correct": false
      }
    ]
  },
  {
    "question": "Commitment is essential to achieve the benefits of Scrum. What actions demonstrate the commitment of Scrum Team members?",
    "answer": [
      {
        "text": "Work late.",
        "correct": false
      },
      {
        "text": "Help your fellow Scrum Team members.",
        "correct": true
      },
      {
        "text": "Always deliver the items in the Sprint forecast.",
        "correct": false
      },
      {
        "text": "Do your best work.",
        "correct": true
      }
    ]
  },
  {
    "question": "When is it most appropriate for a Scrum Team to change the Definition of Done?",
    "answer": [
      {
        "text": "During Product Backlog refinement.",
        "correct": false
      },
      {
        "text": "Prior to starting a new project.",
        "correct": false
      },
      {
        "text": "During the Sprint Retrospective.",
        "correct": true
      },
      {
        "text": "During Sprint Planning.",
        "correct": false
      }
    ]
  },
  {
    "question": "Which of the following might the Scrum Team discuss during a Sprint Retrospective?",
    "answer": [
      {
        "text": "Methods of communication.",
        "correct": false
      },
      {
        "text": "The way the Scrum Team does Sprint Planning.",
        "correct": false
      },
      {
        "text": "Skills needed to improve the Developers ability to deliver.",
        "correct": false
      },
      {
        "text": "The Definition of Done.",
        "correct": false
      },
      {
        "text": "All of the above.",
        "correct": true
      }
    ]
  },
  {
    "question": "User documentation is part of your Definition of Done. However, there are not enough technical writers for all teams. Your Scrum Team does not have a technical writer. What should the Scrum Team do?",
    "answer": [
      {
        "text": "Form a separate team of technical writers that will work on an on-demand basis for the various Product Owners. Work order will be first in, first out.",
        "correct": false
      },
      {
        "text": "Let the user documentation remain undone and accumulate until after the last development Sprint. It will then be done by any available technical writers.",
        "correct": false
      },
      {
        "text": "Wait until you have a technical writer on your Scrum Team to take care of this.",
        "correct": false
      },
      {
        "text": "The Developers on the Scrum Team should write the user documentation.",
        "correct": true
      }
    ]
  },
  {
    "question": "When is a Product Backlog item considered complete?",
    "answer": [
      {
        "text": "At the end of the Sprint.",
        "correct": false
      },
      {
        "text": "When the item passes all acceptance criteria.",
        "correct": false
      },
      {
        "text": "When the item has gained product sponsor approval.",
        "correct": false
      },
      {
        "text": "When the item meets the Definition of Done.",
        "correct": true
      }
    ]
  },
  {
    "question": "When the Developers determine that they will not be able to finish the complete forecast, who has to be present when reviewing and adjusting the Sprint work selected?",
    "answer": [
      {
        "text": "The Product Owner and all stakeholders.",
        "correct": false
      },
      {
        "text": "The Scrum Master, project manager and the Developers",
        "correct": false
      },
      {
        "text": "The Scrum Master and the Developers.",
        "correct": false
      },
      {
        "text": "The Product Owner and the Developers.",
        "correct": true
      }
    ]
  },
  {
    "question": "What activities would a Product Owner typically undertake in the period between the end of the current Sprint and the start of the next Sprint?",
    "answer": [
      {
        "text": "Refine the Product Backlog.",
        "correct": false
      },
      {
        "text": "Work with the Quality Assurance departments on the Increment of the current Sprint.",
        "correct": false
      },
      {
        "text": "Update the project plan with stakeholders.",
        "correct": false
      },
      {
        "text": "There are no such activities. The next Sprint starts immediately after the current Sprint.",
        "correct": true
      }
    ]
  },
  {
    "question": "Who should know the most about the progress toward the Product Goal?",
    "answer": [
      {
        "text": "The Developers.",
        "correct": false
      },
      {
        "text": "The Project Manager.",
        "correct": false
      },
      {
        "text": "The Scrum Master.",
        "correct": false
      },
      {
        "text": "The Product Owner.",
        "correct": true
      }
    ]
  },
  {
    "question": "Who does the work to make sure Product Backlog items conform to the Definition of Done?",
    "answer": [
      {
        "text": "The Product Owner.",
        "correct": false
      },
      {
        "text": "The Quality Assurance Team.",
        "correct": false
      },
      {
        "text": "The Scrum Team.",
        "correct": false
      },
      {
        "text": "The Developers.",
        "correct": true
      },
      {
        "text": "The Scrum Master.",
        "correct": false
      }
    ]
  },
  {
    "question": "Which of the following is required by Scrum?",
    "answer": [
      {
        "text": "Sprint Retrospective.",
        "correct": true
      },
      {
        "text": "Developers must stand up at the Daily Scrum.",
        "correct": false
      },
      {
        "text": "Sprint Burndown Chart.",
        "correct": false
      },
      {
        "text": "Release Planning.",
        "correct": false
      },
      {
        "text": "All of the above.",
        "correct": false
      }
    ]
  },
  {
    "question": "True or False: The Product Owner makes sure the Developers select enough from the Product Backlog for a Sprint to satisfy the stakeholders.",
    "answer": [
      {
        "text": "True",
        "correct": false
      },
      {
        "text": "False",
        "correct": true
      }
    ]
  },
  {
    "question": "What is the Scrum Master responsible for during the Sprint Retrospective?",
    "answer": [
      {
        "text": "Summarizing and reporting the discussions to management.",
        "correct": false
      },
      {
        "text": "Acting as a scribe to capture the Scrum Team's answers.",
        "correct": false
      },
      {
        "text": "Participating as a Scrum Team member and facilitating as requested or needed.",
        "correct": true
      },
      {
        "text": "Prioritizing the resulting action items.",
        "correct": false
      }
    ]
  },
  {
    "question": "Who determines how work is performed during the Sprint?",
    "answer": [
      {
        "text": "The Scrum Team.",
        "correct": false
      },
      {
        "text": "Subject matter experts.",
        "correct": false
      },
      {
        "text": "Team manager.",
        "correct": false
      },
      {
        "text": "The Developers",
        "correct": true
      },
      {
        "text": "The Scrum Master.",
        "correct": false
      }
    ]
  },
  {
    "question": "When does a Developer become accountable for an item in the Sprint Backlog?",
    "answer": [
      {
        "text": "As soon as a Developer on the Scrum Team can accommodate more work.",
        "correct": false
      },
      {
        "text": "During the Daily Scrum.",
        "correct": false
      },
      {
        "text": "At Sprint Planning when all of the Sprint Backlog items are split evenly across the Developers.",
        "correct": false
      },
      {
        "text": "Never. All Developers on the Scrum Team share accountability for items in the Sprint Backlog.",
        "correct": true
      }
    ]
  },
  {
    "question": "At the seventh Sprint Review, the stakeholders are disappointed and angry. They have determined that the product or system being built will not meet their needs and will cost more than they are willing to spend. What factors likely led to this?",
    "answer": [
      {
        "text": "The stakeholders were not allowed to prioritize Product Backlog items.",
        "correct": false
      },
      {
        "text": "The Product Owner has not been keeping the stakeholders aware of the progress of the project.",
        "correct": true
      },
      {
        "text": "The Project Management Office (PMO) has not been engaged adequately.",
        "correct": false
      },
      {
        "text": "The stakeholders have not been using the Sprint Reviews to inspect and evaluate progress.",
        "correct": true
      }
    ]
  },
  {
    "question": "Who has the final decision about the order of items in the Product Backlog?",
    "answer": [
      {
        "text": "The Product Owner.",
        "correct": true
      },
      {
        "text": "The Developers.",
        "correct": false
      },
      {
        "text": "The Scrum Master.",
        "correct": false
      },
      {
        "text": "The Scrum Team.",
        "correct": false
      },
      {
        "text": "The Stakeholders.",
        "correct": false
      }
    ]
  },
  {
    "question": "A Scrum Team is required to deliver a done Increment by the end of a Sprint. Select two statements that explain what done means.",
    "answer": [
      {
        "text": "All work the Developers are willing to do.",
        "correct": false
      },
      {
        "text": "Ready to be released to end users.",
        "correct": true
      },
      {
        "text": "No work is left to meet the Definition of Done.",
        "correct": true
      },
      {
        "text": "Whatever the Product Owner defines as quality.",
        "correct": false
      },
      {
        "text": "Ready for integration.",
        "correct": false
      }
    ]
  },
  {
    "question": "Who is accountable for clearly expressing Product Backlog items?",
    "answer": [
      {
        "text": "The Scrum Master, or the Scrum Master may have the Developers do it.",
        "correct": false
      },
      {
        "text": "The Product Owner.",
        "correct": true
      },
      {
        "text": "The business analyst who represents the Product Owner.",
        "correct": false
      },
      {
        "text": "The Scrum Master.",
        "correct": false
      }
    ]
}
];


const progressText = document.getElementById("progress-text");
const progressBar = document.getElementById("progress-bar");
const questionElement = document.getElementById("question");
const answerButtons = document.getElementById("answer-buttons");
const nextButton = document.getElementById("next-btn");
const timerElement = document.getElementById("timer");

const FULL_DASH_ARRAY = 2 * Math.PI * 26; // Umfang des Kreises (r=26)
const timerCircle = document.querySelector("#circle-timer circle");
const timerText = document.getElementById("circle-timer-text");

let currentQuestionIndex = 0;
let score = 0;
let answered = false;
let timerInterval;
let timeLeft = 50;
const maxTime = 50;

function startQuiz() {
    currentQuestionIndex = 0;
    score = 0;
    nextButton.innerHTML = "Antwort prüfen";
    showQuestion();
}

function showQuestion() {
    resetState();
    answered = false;
    let currentQuestion = questions[currentQuestionIndex];
    let questionNo = currentQuestionIndex + 1;
    questionElement.innerHTML = questionNo + ". " + currentQuestion.question;

    // Prüfen, wie viele richtige Antworten es gibt
    const correctCount = currentQuestion.answer.filter(a => a.correct).length;
    const inputType = correctCount > 1 ? "checkbox" : "radio";

    currentQuestion.answer.forEach((answer, idx) => {
        const label = document.createElement("label");
        label.style.display = "block";
        const input = document.createElement("input");
        input.type = inputType;
        input.name = "answer";
        input.value = idx;
        label.appendChild(input);
        label.appendChild(document.createTextNode(" " + answer.text));
        answerButtons.appendChild(label);
    });
    nextButton.style.display = "block";
    nextButton.innerHTML = "Antwort prüfen";
    nextButton.onclick = selectAnswer;

    // Fortschrittsbalken und Text aktualisieren
    progressText.textContent = `Frage ${currentQuestionIndex + 1} von ${questions.length}`;
    progressBar.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;

    // Timer starten
    startTimer();
}

function startTimer() {
    clearInterval(timerInterval);
    timeLeft = maxTime;
    updateCircleTimer();

    timerInterval = setInterval(() => {
        timeLeft--;
        updateCircleTimer();
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            selectAnswer(true); // Timer abgelaufen, automatisch auswerten
        }
    }, 1000);
}

function updateCircleTimer() {
    // Kreis-Text
    timerText.textContent = timeLeft;

    // Kreis-Farbe
    let color = "#00c853"; // grün
    if (timeLeft <= maxTime * 0.3) {
        color = "#d50000"; // rot
    } else if (timeLeft <= maxTime * 0.6) {
        color = "#ff9800"; // orange
    }
    timerCircle.setAttribute("stroke", color);

    // Kreis-Fortschritt
    const progress = timeLeft / maxTime;
    timerCircle.setAttribute(
        "stroke-dasharray",
        `${progress * FULL_DASH_ARRAY} ${FULL_DASH_ARRAY}`
    );
}

function resetState() {
    while (answerButtons.firstChild) {
        answerButtons.removeChild(answerButtons.firstChild);
    }
    nextButton.style.display = "none";
    clearInterval(timerInterval); // Timer stoppen, wenn Frage gewechselt wird
}

function selectAnswer(timeout = false) {
    if (answered) return;
    answered = true;
    clearInterval(timerInterval);

    const inputs = answerButtons.querySelectorAll('input[name="answer"]');
    const correct = questions[currentQuestionIndex].answer.map(a => a.correct);

    const isMultiple = inputs.length > 0 && inputs[0].type === "checkbox";
    let isCorrect = false;

    if (isMultiple) {
        const selected = Array.from(inputs).map(input => input.checked);
        isCorrect = selected.every((val, idx) => val === correct[idx]);
    } else {
        const selectedIndex = Array.from(inputs).findIndex(input => input.checked);
        isCorrect = correct[selectedIndex] === true && correct.filter(c => c).length === 1;
    }

    if(isCorrect) score++;

    Array.from(inputs).forEach((input, idx) => {
        if (correct[idx]) {
            input.parentElement.style.background = "#90ee90";
        } else if (input.checked) {
            input.parentElement.style.background = "#ffcccb";
        } else {
            input.parentElement.style.background = "";
        }
        input.disabled = true;
    });

    if (timeout) {
        // Optional: Zeige Hinweis, dass die Zeit abgelaufen ist
        nextButton.innerHTML = "Zeit abgelaufen – Weiter";
    } else {
        nextButton.innerHTML = currentQuestionIndex < questions.length - 1 ? "Next" : "Show Score";
    }
    nextButton.onclick = handleNextButton;
}

function showScore() {
    resetState();
    questionElement.innerHTML = `Du hast ${score} von ${questions.length} Punkten erreicht!`;
    nextButton.innerHTML = "Nochmal spielen";
    nextButton.style.display = "block";
    nextButton.onclick = startQuiz;
}

function handleNextButton() {
    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
        showQuestion();
    } else {
        showScore();
    }
}

startQuiz();